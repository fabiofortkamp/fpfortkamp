{
  "hash": "f2d4a70db825b5f0534e0ebcb60688c9",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: 'Compressibility and Expandability: what are they and how to calculate'\nauthor: Fábio P. Fortkamp\ndate: '2022-11-10'\nslug: compressibility\ncategories:\n  - Articles\ntags:\n  - thermodynamics\n---\n\nOne of my disappointments back when I was teaching is that I never taught a Thermodynamics class. I heard it is a terrible subject to teach, with high failing rates, but I'd like to have that experience nevertheless. \n\nSpeaking as someone who studied Thermodynamics as an undergrad student and then during graduate school, and who taught classes that depended on Thermodynamics, I think there is a big specific problem with these courses: students have this subject too early in the curriculum, without the maturity to proper understand the difficult concepts. Also, it becomes too easy to forget what you saw in a Thermodynamics class 15 years ago.\n\n## Expansion coefficients\n\nI'm telling this story from personal experience: I'm working on a project where I have to deal with two \"expansion coefficients\" that all substances have -- how they expand (or contract) upon receiving energy -- , but that do not appear often in most thermodynamic analyses. Hence, I had to go back to the textbooks to understand them.\n\nI'm taking the definitions below from [1]. The first coefficient is the *volumetric isobaric expansivity*, which measured how the volume of a substance changes you heat it up at constant pressure:\n\n$$\n\\beta = \\frac{1}{v}\\left(\\frac{\\partial v}{\\partial T}\\right)_p\n$$\n\nwhere $v$ is the specific volume, $p$  is the pressure and $T$ the absolute temperature. This coefficient has units of K$^{-1}$, and can be negative; famously, liquid water expands when cooled down below 4 ºC (this is why water bottles can break in the freezer). Most substances, however, expand when heated up ($\\beta > 0$). \n\nThe volumetric expansivity may be familiar to Heat Transfer students, and it appears in Free Convection theory; fluids with large values of $\\beta$ change density substantially and then move around quickly when temperature gradients are present.\n\nThe other coefficient is the *isothermal compressibility*:\n\n$$\n\\alpha = -v \\left(\\frac{\\partial v}{\\partial p}\\right)_T\n$$\n\nThis coefficient, with units of Pa$^{-1}$ can never be negative: if you exert force in a piston with some fluid at constant temperature, it *will* contract.\n\n## Calculating expansivity and compressibility with CoolProp\n\nBeware that the coefficients above have many names, depending on the source you are using. To calculate them using the CoolProp library in Python, for instance, I had to look up the [available functions](http://www.coolprop.org/coolprop/HighLevelAPI.html#parameter-table). \n\nNotice that, as derivatives of $p-v-T$ relations, $\\alpha$ and $\\beta$ are properties of state, depending on two other properties to be calculated. For instance, the expansivity of air at atmospheric pressure and ambient temperature is:\n\n::: {#29362590 .cell execution_count=1}\n``` {.python .cell-code}\nfrom CoolProp.CoolProp import PropsSI\nT0 = 298 # K\nP0 = 101.325e3 # Pa\nfluid = 'Air'\nbeta = PropsSI(\"ISOBARIC_EXPANSION_COEFFICIENT\",\"T\",T0,\"P\",P0,fluid)\nprint(\"%.3e K^-1\" %(beta,))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n3.365e-03 K^-1\n```\n:::\n:::\n\n\nAnd the compressibility can be calculated as:\n\n::: {#bdc310da .cell execution_count=2}\n``` {.python .cell-code}\nalpha = PropsSI(\"ISOTHERMAL_COMPRESSIBILITY\",\"T\",T0,\"P\",P0,fluid)\nprint(\"%.3e Pa^-1\" %(alpha,))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n9.872e-06 Pa^-1\n```\n:::\n:::\n\n\n## Relationship to specific heat\n\nThe Mayer relation is [1]:\n\n$$\nc_p - c_v = \\frac{vT\\beta^2}{\\alpha}\n$$\n\nwhere $c_p$ and $c_v$ are respectively the constant-pressure and constant-volume speficic heats. The right hand side is always non-negative, which enforces $c_p \\ge c_v$. The equality sign applies from *incompressible substances*, for which $\\beta = 0$. \n\nLet us verify that relation:\n\n::: {#93d9cb85 .cell execution_count=3}\n``` {.python .cell-code}\nc_p = PropsSI(\"CPMASS\",\"T\",T0,\"P\",P0,fluid)\nc_v = PropsSI(\"CVMASS\",\"T\",T0,\"P\",P0,fluid)\nv = 1/PropsSI(\"D\",\"T\",T0,\"P\",P0,fluid)\nprint(c_p - c_v - v*T0*beta**2/alpha)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n0.0\n```\n:::\n:::\n\n\n### An aside about how these properties are calculated\n\nEngineers should beware of black boxes. In the examples above (and below), what exactly is CoolProp doing?\n\nIf you are doing a serious project involving thermodynamic and transport properties, you should definitely check out the [CoolProp documentation on fluid properties](http://www.coolprop.org/fluid_properties/PurePseudoPure.html)\n\nAs explained before, $\\alpha$ and $\\beta$ can be calculated with only knowledge of the equation of state (EOS). Specific heats cannot be calculated from an EOS; additional information about the *energy* of the fluid is needed [2], usually from empirical correlations. What the Mayer relation enforces is that *only the difference between specific heats* can be determined from an EOS; but if you also have a model for $c_p$, you can calculate $c_v$ and vice-versa. You don't need two different models for the two specific heats.\n\nCheck out the CoolProp documentation page above to see what other information, besides the EOS, is needed to build up the CoolProp database.\n\n## Comparison between gases\n\nIf we pick only gases commonly present in mechanical engineering applications, how do the values of $\\alpha$ and $\\beta$ vary between them?\n\nWhen doing this sort of analysis, I always find it useful to use [pandas](https://pandas.pydata.org/docs/getting_started/) to build a table and work from there:\n\n::: {#0b8d6c75 .cell execution_count=4}\n``` {.python .cell-code}\nfrom pandas import Series, DataFrame\nimport numpy as np\n\ngases = [\n  \"Air\",\n  \"Argon\",\n  \"CarbonDioxide\",\n  \"Ethane\",\n  \"Helium\",\n  \"IsoButane\",\n  \"Nitrogen\",\n  \"Methane\"]\n  \nalphav = np.empty_like(gases,dtype='float')\nbetav = np.empty_like(gases,dtype='float')\n\nfor i,gas in enumerate(gases):\n  alphav[i] = PropsSI(\"ISOTHERMAL_COMPRESSIBILITY\",\"T\",T0,\"P\",P0,gas)\n  betav[i] = PropsSI(\"ISOBARIC_EXPANSION_COEFFICIENT\",\"T\",T0,\"P\",P0,gas)\n\ndf = DataFrame(\n  {\n    \"Gas\": gases,\n    \"alpha [MPa^-1]\": 1e6*alphav,\n    \"beta [K-1]\": betav\n}\n)\nprint(df)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n             Gas  alpha [MPa^-1]  beta [K-1]\n0            Air        9.872466    0.003365\n1          Argon        9.875500    0.003366\n2  CarbonDioxide        9.919539    0.003412\n3         Ethane        9.945354    0.003435\n4         Helium        9.864455    0.003354\n5      IsoButane       10.145642    0.003660\n6       Nitrogen        9.871181    0.003364\n7        Methane        9.886582    0.003377\n```\n:::\n:::\n\n\nFrankly, this result, with this low variation between gases, surprises me. Mind you that CoolProp is not just using Ideal Gas relations (otherwise the compressibility and expandability of the gases would be equal - prove it!), but is actually using experimental $p-v-T$ data. It just so happens that there is not a wide variation between gases.\n\n## Final remarks\n\nI've written this post because I needed to learn more about these properties, and I hope it will help more people. Please share it if you find it useful!\n\n## References\n\n[1]: Çengel, Y. A., & Boles, M. A. Termodinâmica (7 ed.). Porto Alegre: AMGH, 2013.\n\n[2]: Callen, H. B. Thermodynamics and an Introduction to Thermostatistics (2nd ed.). John Wiley and Sons, 1985.\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [],
    "includes": {}
  }
}
{
  "hash": "83644bf03ca43bf79f139578ff1cb454",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: Calculting equilibrium composition of a mixture of gases - Exercise 16-89 from\n  Çengel's Thermodynamics book (7th ed)\nauthor: Fábio P. Fortkamp\ndate: '2022-03-17'\nslug: equilibrium\ncategories:\n  - Exercise from Çengel's Thermodynamics\ntags:\n  - thermodynamics\n  - chemical thermodynamics\n  - equilibrium\n---\n\n\nThis is exercise 16-89 from [1]: a mixture of 1 mol of $\\mathrm{H_2O}$, 2 mols of $\\mathrm{O_2}$ and 5 mols of $\\mathrm{N_2}$ is heated up to 2200 K and 5 atm of pressure. The final composition will have the formation of $\\mathrm{H_2}$ as well; what is the equilibrium composition, and is it reasonable to assume there will be no $\\mathrm{OH}$ in the final composition?\n\nI teach several classes on heat engines, steam generators and internal combustion engines, and for me the prime application of chemical thermodynamics and equilibrium composition is emissions. For a given combustion reaction, will pollutants such as $\\mathrm{NO}$ and $\\mathrm{CO}$ be formed? How much of them? The exercise explained above is a nice example of such calculations. \n\nAll calculations below assume all components are ideal gases.\n\nFirst, we need to write the reaction:\n\n$$\n\\mathrm{H_2O} + 2\\mathrm{O_2} + 5\\mathrm{N_2} \\to x\\mathrm{H_2O} + y\\mathrm{O_2} + z\\mathrm{N_2} + w\\mathrm{H_2}\n$$\n\nwhere the unknowns ${x,y,v,w}$ form a *vector* to be found with an appropriate system of equations. Since we have three elements ($\\mathrm{N,O,H}$), or equivalently $(\\mathrm{N_2,O_2,H_2})$), we can write three mass balances:\n\nFor hydrogen gas:\n\n$$\nx + w -1 = 0\n$$\n\nFor oxygen gas:\n\n$$\n2.5-0.5x-y=0\n$$\n\nFor nitrogen gas:\n\n$$\n5-z = 0\n$$\n\n(Do you have any doubts on why these equations are as such?)\n\nOne missing equation has to be determined from equilibrium considerations. Looking at tables of equilibrium constants, I posit that the free hydrogen gas is formed by dissociation:\n\n$$\n\\mathrm{H_2O} \\rightleftharpoons \\mathrm{H_2} + \\frac{1}{2}\n\\mathrm{O_2}\n$$\nwhose equilibrium constant at 2200 K is $\\ln K_p = -6.768$.\n\nThe definition of equilibrium coefficient for this latter equation is [1]:\n\n$$\nK_p = \\frac{N_{\\mathrm{H_2}}^{\\nu_{\\mathrm{H_2}}} N_{\\mathrm{O_2}}^{\\nu_{\\mathrm{O_2}}}}{N_{\\mathrm{H_2O}}^{\\nu_{\\mathrm{H_2O}}}}\\left(\\frac{P}{N_{\\mathrm{total}}} \\right)^{\\nu_{\\mathrm{H_2}} + \\nu_{\\mathrm{O_2}} - \\nu_{\\mathrm{H_2O}}}\n$$\nwhere the $\\nu_i$ are the stoichiometric coefficients in the dissociation equation, the $N_i$ are the real molar contents in the actual system where the dissociation occur, and $P$ is the pressure in atm:\n\n$$\nK_p = \\frac{w^{1} y^{0.5}}{x^{1}}\\left(\\frac{5}{x + y + z + w} \\right)^{0.5}\n$$\n\nTake a minute and see if you can understand this equation. It took me almost an hour to properly understand it.\n\nThe vector of unknowns then is the solution of a 4-dimensional function, and this problem can be solved numerically with R:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(rootSolve)\nmodel <- function(a) c(F1 = 1-a[1] - a[4], \n                       F2 = 2.5-0.5*a[1]-a[2],\n                       F3 = 5-a[3],\n                       F4 = ((a[4]*a[2]**0.5)/(a[1])*(5/(sum(a)))^0.5) -exp(-6.768))\n\nss <- multiroot(f = model, start = c(1,1,1,1), positive=TRUE)\nprint(ss)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$root\n[1] 0.998972571 2.000513714 5.000000000 0.001027429\n\n$f.root\n           F1            F2            F3            F4 \n 1.692006e-15 -1.332268e-15  0.000000e+00  1.414678e-13 \n\n$iter\n[1] 4\n\n$estim.precis\n[1] 3.612301e-14\n```\n\n\n:::\n:::\n\nKeep in mind that I had to tweak this code until it worked. For instance, if you write the fourth equation in terms of logarithms, and not with exponentials as I did, you might have some numerical problems (try!). Also, the solution is sensitive to initial conditions; the final solution makes sense, as oxygen and nitrogen are practically preserved and some of the water vapor in fact dissociates. \n\nAs for the underlying assumption: will there be $\\mathrm{OH}$ in the final composition? The equilibrium constant for $\\mathrm{H_2O} \\rightleftharpoons \\mathrm{OH} + \\frac{1}{2} \\mathrm{H_2}$ at 2200 K is $\\ln K_p = -7.148$. The dissociation constants from water vapor to $\\mathrm{H_2}$ and $\\mathrm{OH}$ are very similar, and hence the reactions will occur in parallel, giving some amount of $\\mathrm{OH}$ in the products, contrary to our assumptions. If you actually perform an experiment similar to this problem and encounter some errors in the final composition, this is a likely source of deviations. \n\nThe smaller the value of $K_p$, the harder is for the reaction to occur; you can see from the above equations that this coefficient is a measure of how much products form from the reactants. Hence, for similar $K_p$, the amount of $\\mathrm{H_2}$ and $\\mathrm{OH}$ formed will also be similar.\n\n## References \n\n[1]: Çengel, Y. A., & Boles, M. A. Termodinâmica (7 ed.). Porto Alegre: AMGH, 2013.",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}